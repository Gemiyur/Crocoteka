<Window x:Class="Crocoteka.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Crocoteka"
        mc:Ignorable="d"
        Title="Крокотека"
        Width="950" Height="650" ResizeMode="CanResizeWithGrip"
        MinWidth="800" MinHeight="450"
        d:Width="800" d:Height="450"
        WindowStartupLocation="CenterScreen"
        Loaded="Window_Loaded"
        Closed="Window_Closed">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="MainDictionary.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>

    <Window.CommandBindings>
        <!-- Команды библиотеки -->
        <CommandBinding Command="local:AppCommands.Settings"
                        Executed="Settings_Executed" />
        <CommandBinding Command="local:AppCommands.Exit"
                        Executed="Exit_Executed" />
        <!-- Команды книг -->
        <CommandBinding Command="local:AppCommands.AddBook"
                        Executed="AddBook_Executed" />
        <CommandBinding Command="local:AppCommands.FindBooks"
                        Executed="FindBooks_Executed" />
        <CommandBinding Command="local:AppCommands.BookInfo"
                        CanExecute="BookInfo_CanExecute"
                        Executed="BookInfo_Executed" />
        <CommandBinding Command="local:AppCommands.BookEdit"
                        CanExecute="BookEdit_CanExecute"
                        Executed="BookEdit_Executed" />
        <CommandBinding Command="local:AppCommands.BookDelete"
                        CanExecute="BookDelete_CanExecute"
                        Executed="BookDelete_Executed" />
        <!-- Команды авторов -->
        <CommandBinding Command="local:AppCommands.Authors"
                        Executed="Authors_Executed" />
        <CommandBinding Command="local:AppCommands.AuthorInfo"
                        Executed="AuthorInfo_Executed" />
        <CommandBinding Command="local:AppCommands.AuthorEdit"
                        Executed="AuthorEdit_Executed" />
        <CommandBinding Command="local:AppCommands.AuthorDelete"
                        CanExecute="AuthorDelete_CanExecute"
                        Executed="AuthorDelete_Executed" />
        <!-- Команды серий -->
        <CommandBinding Command="local:AppCommands.Cycles"
                        Executed="Cycles_Executed" />
        <CommandBinding Command="local:AppCommands.CycleInfo"
                        Executed="CycleInfo_Executed" />
        <CommandBinding Command="local:AppCommands.CycleEdit"
                        Executed="CycleEdit_Executed" />
        <CommandBinding Command="local:AppCommands.CycleDelete"
                        CanExecute="CycleDelete_CanExecute"
                        Executed="CycleDelete_Executed" />
        <!-- Команды жанров -->
        <CommandBinding Command="local:AppCommands.Genres"
                        Executed="Genres_Executed" />
        <CommandBinding Command="local:AppCommands.GenreEdit"
                        Executed="GenreEdit_Executed" />
        <CommandBinding Command="local:AppCommands.GenreDelete"
                        CanExecute="GenreDelete_CanExecute"
                        Executed="GenreDelete_Executed" />
        <!-- Команды справки -->
        <CommandBinding Command="local:AppCommands.About"
                        Executed="About_Executed" />
    </Window.CommandBindings>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <Menu Grid.Row="0">
            <MenuItem Header="Библиотека">
                <MenuItem Style="{StaticResource MenuItemStyle}"
                          Command="local:AppCommands.AddBook">
                    <MenuItem.Icon>
                        <Image Source="Images\Buttons\Enabled\AddBook.png" />
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Style="{StaticResource MenuItemStyle}"
                          Command="local:AppCommands.FindBooks">
                    <MenuItem.Icon>
                        <Image Source="Images\Buttons\Enabled\FindBooks.png" />
                    </MenuItem.Icon>
                </MenuItem>
                <Separator />
                <MenuItem Style="{StaticResource MenuItemStyle}"
                          Command="local:AppCommands.Authors">
                    <MenuItem.Icon>
                        <Image Source="Images\Buttons\Enabled\Authors.png" />
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Style="{StaticResource MenuItemStyle}"
                          Command="local:AppCommands.Cycles">
                    <MenuItem.Icon>
                        <Image Source="Images\Buttons\Enabled\Cycles.png" />
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Style="{StaticResource MenuItemStyle}"
                          Command="local:AppCommands.Genres">
                    <MenuItem.Icon>
                        <Image Source="Images\Buttons\Enabled\Genres.png" />
                    </MenuItem.Icon>
                </MenuItem>
                <Separator />
                <MenuItem Style="{StaticResource MenuItemStyle}"
                          Command="local:AppCommands.Settings">
                    <MenuItem.Icon>
                        <Image Source="Images\Buttons\Enabled\Settings.png" />
                    </MenuItem.Icon>
                </MenuItem>
                <Separator />
                <MenuItem x:Name="ExitMenuItem" Style="{StaticResource MenuItemStyle}"
                          Command="local:AppCommands.Exit" />
            </MenuItem>
            <MenuItem Header="Книга">
                <MenuItem x:Name="BookInfoMenuItem" Style="{StaticResource MenuItemStyle}"
                          Command="local:AppCommands.BookInfo">
                    <MenuItem.Icon>
                        <Image Source="Images\Buttons\Enabled\BookInfo.png" />
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem x:Name="BookEditMenuItem" Style="{StaticResource MenuItemStyle}"
                          Command="local:AppCommands.BookEdit">
                    <MenuItem.Icon>
                        <Image Source="Images\Buttons\Enabled\Edit.png" />
                    </MenuItem.Icon>
                </MenuItem>
                <Separator />
                <MenuItem x:Name="BookDeleteMenuItem" Style="{StaticResource MenuItemStyle}"
                          Command="local:AppCommands.BookDelete">
                    <MenuItem.Icon>
                        <Image Source="Images\Buttons\Enabled\Delete.png" />
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
            <MenuItem Header="Справка">
                <MenuItem Style="{StaticResource MenuItemStyle}"
                          Command="local:AppCommands.About">
                    <MenuItem.Icon>
                        <Image Source="Images\Buttons\Enabled\About.png" />
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
        </Menu>

        <ToolBarTray Grid.Row="1">
            <ToolBar x:Name="LibraryToolBar">
                <Button Style="{StaticResource ToolBarButtonStyle}"
                        Command="local:AppCommands.AddBook">
                    <Image Source="Images\Buttons\Enabled\AddBook.png" Style="{StaticResource ToolBarIconStyle}" />
                </Button>
                <Button Style="{StaticResource ToolBarButtonStyle}"
                        Command="local:AppCommands.FindBooks">
                    <Image Source="Images\Buttons\Enabled\FindBooks.png" Style="{StaticResource ToolBarIconStyle}" />
                </Button>
                <Separator />
                <Button Style="{StaticResource ToolBarButtonStyle}"
                        Command="local:AppCommands.Authors">
                    <Image Source="Images\Buttons\Enabled\Authors.png" Style="{StaticResource ToolBarIconStyle}" />
                </Button>
                <Button Style="{StaticResource ToolBarButtonStyle}"
                        Command="local:AppCommands.Cycles">
                    <Image Source="Images\Buttons\Enabled\Cycles.png" Style="{StaticResource ToolBarIconStyle}" />
                </Button>
                <Button Style="{StaticResource ToolBarButtonStyle}"
                        Command="local:AppCommands.Genres">
                    <Image Source="Images\Buttons\Enabled\Genres.png" Style="{StaticResource ToolBarIconStyle}" />
                </Button>
                <Separator />
                <Button Style="{StaticResource ToolBarButtonStyle}"
                        Command="local:AppCommands.Settings">
                    <Image Source="Images\Buttons\Enabled\Settings.png" Style="{StaticResource ToolBarIconStyle}" />
                </Button>
            </ToolBar>
            <ToolBar x:Name="BookToolBar">
                <Button x:Name="BookInfoButton" Style="{StaticResource ToolBarButtonStyle}"
                        Command="local:AppCommands.BookInfo">
                    <Image Source="Images\Buttons\Enabled\BookInfo.png" Style="{StaticResource ToolBarIconStyle}" />
                </Button>
                <Separator />
                <Button x:Name="BookEditButton" Style="{StaticResource ToolBarButtonStyle}"
                        Command="local:AppCommands.BookEdit">
                    <Image Source="Images\Buttons\Enabled\Edit.png" Style="{StaticResource ToolBarIconStyle}" />
                </Button>
                <Separator />
                <Button x:Name="BookDeleteButton" Style="{StaticResource ToolBarButtonStyle}"
                        Command="local:AppCommands.BookDelete">
                    <Image Source="Images\Buttons\Enabled\Delete.png" Style="{StaticResource ToolBarIconStyle}" />
                </Button>
            </ToolBar>
            <ToolBar x:Name="HelpToolBar">
                <Button Style="{StaticResource ToolBarButtonStyle}"
                        Command="local:AppCommands.About">
                    <Image Source="Images\Buttons\Enabled\About.png" Style="{StaticResource ToolBarIconStyle}" />
                </Button>
            </ToolBar>
        </ToolBarTray>

        <!-- Панель навигации и список книг -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="225" MinWidth="150" MaxWidth="300" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <!-- Панель навигации -->
            <Border Grid.Column="0" BorderBrush="MidnightBlue" BorderThickness="0.5">
                <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto" Margin="10,0,0,0">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <ToggleButton Grid.Row="0" x:Name="AllBooksToggleButton" Content="Все книги"
                                      Style="{StaticResource NavToggleButtonStyle}"
                                      DataContext="/Images/Buttons/Enabled/AllBooks.png"
                                      IsChecked="True"
                                      Click="AllBooksToggleButton_Click" />
                        <Expander Grid.Row="2" x:Name="AuthorsExpander" Header="Авторы"
                                  Style="{StaticResource NavExpanderStyle}">
                            <ListBox x:Name="AuthorsListBox"
                                     Style="{StaticResource NavListBoxStyle}"
                                     ItemContainerStyle="{StaticResource ListBoxItemStyle}"
                                     ItemTemplate="{StaticResource AuthorFullNameDataTemplate}"
                                     SelectionChanged="AuthorsListBox_SelectionChanged">
                                <ListBox.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem x:Name="AuthorInfoContextMenuItem"
                                                  Style="{StaticResource MenuItemStyle}"
                                                  Command="local:AppCommands.AuthorInfo">
                                            <MenuItem.Icon>
                                                <Image Source="Images\Buttons\Enabled\Info.png" />
                                            </MenuItem.Icon>
                                        </MenuItem>
                                        <MenuItem x:Name="AuthorEditContextMenuItem"
                                                  Style="{StaticResource MenuItemStyle}"
                                                  Command="local:AppCommands.AuthorEdit">
                                            <MenuItem.Icon>
                                                <Image Source="Images\Buttons\Enabled\Edit.png" />
                                            </MenuItem.Icon>
                                        </MenuItem>
                                        <MenuItem x:Name="AuthorDeleteContextMenuItem"
                                                  Style="{StaticResource MenuItemStyle}"
                                                  Command="local:AppCommands.AuthorDelete">
                                            <MenuItem.Icon>
                                                <Image Source="Images\Buttons\Enabled\Delete.png" />
                                            </MenuItem.Icon>
                                        </MenuItem>
                                    </ContextMenu>
                                </ListBox.ContextMenu>
                            </ListBox>
                        </Expander>
                        <Expander Grid.Row="3" x:Name="CyclesExpander" Header="Серии"
                                  Style="{StaticResource NavExpanderStyle}">
                            <ListBox x:Name="CyclesListBox"
                                     Style="{StaticResource NavListBoxStyle}"
                                     ItemContainerStyle="{StaticResource ListBoxItemStyle}"
                                     ItemTemplate="{StaticResource CycleDataTemplate}"
                                     SelectionChanged="CyclesListBox_SelectionChanged">
                                <ListBox.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem x:Name="CycleInfoContextMenuItem"
                                                  Style="{StaticResource MenuItemStyle}"
                                                  Command="local:AppCommands.CycleInfo">
                                            <MenuItem.Icon>
                                                <Image Source="Images\Buttons\Enabled\Info.png" />
                                            </MenuItem.Icon>
                                        </MenuItem>
                                        <MenuItem x:Name="CycleEditContextMenuItem"
                                                  Style="{StaticResource MenuItemStyle}"
                                                  Command="local:AppCommands.CycleEdit">
                                            <MenuItem.Icon>
                                                <Image Source="Images\Buttons\Enabled\Edit.png" />
                                            </MenuItem.Icon>
                                        </MenuItem>
                                        <MenuItem x:Name="CycleDeleteContextMenuItem"
                                                  Style="{StaticResource MenuItemStyle}"
                                                  Command="local:AppCommands.CycleDelete">
                                            <MenuItem.Icon>
                                                <Image Source="Images\Buttons\Enabled\Delete.png" />
                                            </MenuItem.Icon>
                                        </MenuItem>
                                    </ContextMenu>
                                </ListBox.ContextMenu>
                            </ListBox>
                        </Expander>
                        <Expander Grid.Row="4" x:Name="GenresExpander" Header="Жанры"
                                  Style="{StaticResource NavExpanderStyle}">
                            <ListBox x:Name="GenresListBox"
                                     Style="{StaticResource NavListBoxStyle}"
                                     ItemContainerStyle="{StaticResource ListBoxItemStyle}"
                                     ItemTemplate="{StaticResource GenreDataTemplate}"
                                     SelectionChanged="GenresListBox_SelectionChanged">
                                <ListBox.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem x:Name="GenreEditContextMenuItem"
                                                  Style="{StaticResource MenuItemStyle}"
                                                  Command="local:AppCommands.GenreEdit">
                                            <MenuItem.Icon>
                                                <Image Source="Images\Buttons\Enabled\Edit.png" />
                                            </MenuItem.Icon>
                                        </MenuItem>
                                        <MenuItem x:Name="GenreDeleteContextMenuItem"
                                                  Style="{StaticResource MenuItemStyle}"
                                                  Command="local:AppCommands.GenreDelete">
                                            <MenuItem.Icon>
                                                <Image Source="Images\Buttons\Enabled\Delete.png" />
                                            </MenuItem.Icon>
                                        </MenuItem>
                                    </ContextMenu>
                                </ListBox.ContextMenu>
                            </ListBox>
                        </Expander>
                    </Grid>
                </ScrollViewer>
            </Border>
            <!-- Сплиттер -->
            <GridSplitter Grid.Row="1" Grid.Column="1" Width="5"
                          HorizontalAlignment="Center" VerticalAlignment="Stretch" />
            <!-- Список книг -->
            <ListView Grid.Row="1" Grid.Column="2" x:Name="BooksListView"
                      ItemContainerStyle="{StaticResource ListViewItemStyle}"
                      SelectionMode="Single"
                      ContextMenuOpening="BooksListView_ContextMenuOpening"
                      MouseDoubleClick="BooksListView_MouseDoubleClick"
                      SizeChanged="BooksListView_SizeChanged">
                <ListView.View>
                    <GridView>
                        <GridView.ColumnHeaderContainerStyle>
                            <Style TargetType="GridViewColumnHeader">
                                <Setter Property="IsEnabled" Value="False"/>
                                <Style.Triggers>
                                    <Trigger Property="IsEnabled" Value="False">
                                        <Setter Property="TextElement.Foreground" Value="Black" />
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </GridView.ColumnHeaderContainerStyle>
                        <GridViewColumn x:Name="BooksListViewTitleColumn" Header="Название"
                                        CellTemplate="{StaticResource BookDataTemplate}" />
                        <GridViewColumn Header="Файлов" Width="60">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding FilesCountText}"
                                               Foreground="{StaticResource BooksListViewForegroundBrush}"
                                               HorizontalAlignment="Center" />
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>
                        <GridViewColumn Header="Аудио" Width="50">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding AudioCountText}"
                                               Foreground="{StaticResource BooksListViewForegroundBrush}"
                                               HorizontalAlignment="Center" />
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>
                        <GridViewColumn Header="Текст" Width="50">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding TextCountText}"
                                               Foreground="{StaticResource BooksListViewForegroundBrush}"
                                               HorizontalAlignment="Center" />
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>
                        <GridViewColumn Header="?" Width="50">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding UnknownCountText}"
                                               Foreground="{StaticResource BooksListViewForegroundBrush}"
                                               HorizontalAlignment="Center" />
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>
                        <GridViewColumn Header="Нет файла" Width="65">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding NotFoundCountText}"
                                               Foreground="Red"
                                               HorizontalAlignment="Center" />
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>
                    </GridView>
                </ListView.View>
                <ListView.ContextMenu>
                    <ContextMenu x:Name="BookContextMenu">
                        <MenuItem x:Name="BookInfoContextMenuItem"
                                  Style="{StaticResource MenuItemStyle}"
                                  Command="local:AppCommands.BookInfo">
                            <MenuItem.Icon>
                                <Image Source="Images\Buttons\Enabled\BookInfo.png" />
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem x:Name="BookEditContextMenuItem"
                                  Style="{StaticResource MenuItemStyle}"
                                  Command="local:AppCommands.BookEdit">
                            <MenuItem.Icon>
                                <Image Source="Images\Buttons\Enabled\Edit.png" />
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem x:Name="BookDeleteContextMenuItem"
                                  Style="{StaticResource MenuItemStyle}"
                                  Command="local:AppCommands.BookDelete">
                            <MenuItem.Icon>
                                <Image Source="Images\Buttons\Enabled\Delete.png" />
                            </MenuItem.Icon>
                        </MenuItem>
                    </ContextMenu>
                </ListView.ContextMenu>
            </ListView>
        </Grid>

        <StatusBar Grid.Row="3">
            <StatusBarItem Margin="4,0,0,0">
                <TextBlock Text="Книг:"/>
            </StatusBarItem>
            <StatusBarItem>
                <TextBlock x:Name="BooksCountTextBlock" />
            </StatusBarItem>
            <StatusBarItem Margin="10,0,20,0" HorizontalAlignment="Right">
                <TextBlock x:Name="NavItemTextBlock" Text="Все книги" />
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
