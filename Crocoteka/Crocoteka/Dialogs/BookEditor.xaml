<Window x:Class="Crocoteka.Dialogs.BookEditor"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Crocoteka.Dialogs"
        mc:Ignorable="d"
        Title="Книга"
        Width="500" Height="550" ResizeMode="NoResize"
        WindowStartupLocation="CenterOwner"
        ShowInTaskbar="False">

    <Window.Resources>
        <ResourceDictionary>
            <Style x:Key="ButtonStyle" TargetType="Button">
                <Setter Property="Width" Value="85" />
                <Setter Property="Height" Value="25" />
            </Style>
            
            <Style x:Key="EditorButtonStyle" TargetType="Button">
                <Setter Property="Width" Value="75" />
                <Setter Property="Height" Value="20" />
            </Style>

            <Style x:Key="DividerColumnStyle" TargetType="ColumnDefinition">
                <Setter Property="Width" Value="16" />
            </Style>
            
            <Style x:Key="FilesButtonStyle" TargetType="Button">
                <Setter Property="Width" Value="95" />
                <Setter Property="Height" Value="20" />
            </Style>
        </ResourceDictionary>
    </Window.Resources>

    <Grid Margin="10,10,10,10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition />
            <RowDefinition Height="16" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Название книги -->
        <GroupBox Grid.Row="0" Header="Название">
            <TextBox x:Name="TitleTextBox"
                     Margin="0,4,0,0"
                     TextChanged="TitleTextBox_TextChanged" />
        </GroupBox>

        <!-- Вкладки редактора -->
        <TabControl Grid.Row="1" Margin="0,10,0,0">
            <TabItem Header="Авторы и серия">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <!-- Авторы -->
                    <GroupBox Grid.Row="0" Header="Авторы" Margin="0,10,0,0">
                        <Grid Margin="0,4,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <ListBox Grid.Column="0" x:Name="AuthorsListBox"
                                     ItemContainerStyle="{StaticResource ListBoxItemStyle}"
                                     ItemTemplate="{StaticResource AuthorFullNameDataTemplate}"
                                     Height="110"
                                     Margin="0,0,10,0"
                                     SelectionMode="Extended"
                                     SelectionChanged="AuthorsListBox_SelectionChanged">
                            </ListBox>
                            <Grid Grid.Column="1">
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition />
                                    <RowDefinition />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <Button Grid.Row="0" x:Name="PickAuthorsButton" Content="Выбрать"
                                        Style="{StaticResource EditorButtonStyle}"
                                        VerticalAlignment="Top"
                                        Margin="0,0,0,10" 
                                        Click="PickAuthorsButton_Click" />
                                <Button Grid.Row="1" x:Name="NewAuthorButton" Content="Новый"
                                        Style="{StaticResource EditorButtonStyle}"
                                        VerticalAlignment="Top"
                                        Margin="0,0,0,10" 
                                        Click="NewAuthorButton_Click" />
                                <Button Grid.Row="2" x:Name="EditAuthorButton" Content="Изменить"
                                        Style="{StaticResource EditorButtonStyle}"
                                        IsEnabled="False"
                                        VerticalAlignment="Top"
                                        Margin="0,0,0,10" 
                                        Click="EditAuthorButton_Click" />
                                <Button Grid.Row="3" x:Name="RemoveAuthorsButton" Content="Удалить"
                                        Style="{StaticResource EditorButtonStyle}"
                                        IsEnabled="False"
                                        VerticalAlignment="Bottom"
                                        Click="RemoveAuthorsButton_Click" />
                            </Grid>
                        </Grid>
                    </GroupBox>
                    <GroupBox Grid.Row="1" Header="Серия" Margin="0,20,0,0">
                        <Grid Margin="0,4,0,0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="10" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="10" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="10" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBox Grid.Row="0" Grid.Column="0" x:Name="CycleTextBox"
                                     IsReadOnly="True"
                                     IsReadOnlyCaretVisible="True"
                                     Background="{StaticResource TextBoxReadOnlyBackgroundBrush}"
                                     TextChanged="CycleTextBox_TextChanged" />
                            <Grid Grid.Row="2" Grid.Column="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="Номера в серии" VerticalAlignment="Center" />
                                <TextBox Grid.Column="1" x:Name="CycleNumbersTextBox"
                                         Margin="10,0,0,0"
                                         Padding="2,0,2,0"
                                         VerticalAlignment="Center"
                                         LostFocus="CycleNumbersTextBox_LostFocus"
                                         TextChanged="CycleNumbersTextBox_TextChanged" />
                            </Grid>
                            <TextBlock Grid.Row="4" Grid.Column="0"
                                       Text="* Номера в серии вводятся через запятую и/или пробел."
                                       VerticalAlignment="Center" />
                            <Button Grid.Row="0" Grid.Column="1" x:Name="PickCycleButton" Content="Выбрать"
                                    Style="{StaticResource EditorButtonStyle}"
                                    Margin="10,0,0,0"
                                    Click="PickCycleButton_Click" />
                            <Button Grid.Row="2" Grid.Column="2" x:Name="NewCycleButton" Content="Новая"
                                    Style="{StaticResource EditorButtonStyle}"
                                    Margin="10,0,0,0"
                                    Click="NewCycleButton_Click" />
                            <Button Grid.Row="4" Grid.Column="2" x:Name="EditCycleButton" Content="Изменить"
                                    Style="{StaticResource EditorButtonStyle}"
                                    Margin="10,0,0,0"
                                    IsEnabled="False"
                                    Click="EditCycleButton_Click" />
                            <Button Grid.Row="6" Grid.Column="2" x:Name="RemoveCycleButton" Content="Удалить"
                                    Style="{StaticResource EditorButtonStyle}"
                                    Margin="10,0,0,0"
                                    IsEnabled="False"
                                    Click="RemoveCycleButton_Click" />
                        </Grid>
                    </GroupBox>
                </Grid>
            </TabItem>

            <TabItem Header="Аннотация">
                <TextBox x:Name="AnnotationTextBox"
                         AcceptsReturn="True"
                         TextWrapping="Wrap"
                         VerticalScrollBarVisibility="Auto"
                         Margin="4,4,4,2" />
            </TabItem>
 
            <TabItem Header="Жанры">
                <Grid Margin="0,4,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid Grid.Row="0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <ListBox Grid.Column="0" x:Name="GenresListBox"
                                 ItemContainerStyle="{StaticResource ListBoxItemStyle}"
                                 ItemTemplate="{StaticResource GenreDataTemplate}"
                                 Margin="4,0,10,0"
                                 SelectionMode="Extended"
                                 SelectionChanged="GenresListBox_SelectionChanged" />
                        <StackPanel Grid.Column="1" Orientation="Vertical">
                            <Button x:Name="PickGenresButton" Content="Выбрать"
                                    Style="{StaticResource EditorButtonStyle}"
                                    VerticalAlignment="Top"
                                    Margin="0,0,4,0"
                                    Click="PickGenresButton_Click" />
                            <Button x:Name="EditGenreButton" Content="Изменить"
                                    Style="{StaticResource EditorButtonStyle}"
                                    VerticalAlignment="Top"
                                    Margin="0,10,4,0"
                                    IsEnabled="False"
                                    Click="EditGenreButton_Click" />
                            <Button x:Name="RemoveGenresButton" Content="Удалить"
                                    Style="{StaticResource EditorButtonStyle}"
                                    VerticalAlignment="Top"
                                    Margin="0,10,4,0"
                                    IsEnabled="False"
                                    Click="RemoveGenresButton_Click" />
                        </StackPanel>
                    </Grid>
                    <Grid Grid.Row="1" Margin="0,10,0,4">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <TextBox Grid.Column="0" x:Name="NewGenreTextBox"
                                 Margin="4,0,10,0"
                                 TextChanged="NewGenreTextBox_TextChanged" />
                        <Button Grid.Column="1" x:Name="AddNewGenreButton" Content="Добавить"
                                Style="{StaticResource EditorButtonStyle}"
                                Margin="0,0,4,0"
                                IsEnabled="False"
                                Click="AddNewGenreButton_Click" />
                    </Grid>
                </Grid>
            </TabItem>

            <TabItem Header="Файлы">
                <Grid Margin="0,4,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid Grid.Row="0" Margin="8,0,8,4">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Style="{StaticResource DividerColumnStyle}" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Style="{StaticResource DividerColumnStyle}" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Style="{StaticResource DividerColumnStyle}" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <StackPanel Grid.Column="0" Orientation="Horizontal">
                            <TextBlock Text="Всего: " />
                            <TextBlock x:Name="TotalFilesTextBlock" Text="0" />
                        </StackPanel>
                        <StackPanel Grid.Column="2" Orientation="Horizontal">
                            <TextBlock Text="Аудио: " />
                            <TextBlock x:Name="AudioFilesTextBlock" Text="0" />
                        </StackPanel>
                        <StackPanel Grid.Column="4" Orientation="Horizontal">
                            <TextBlock Text="Текст: " />
                            <TextBlock x:Name="TextFilesTextBlock" Text="0" />
                        </StackPanel>
                        <StackPanel Grid.Column="6" x:Name="UnknownFilesStackPanel" Orientation="Horizontal">
                            <TextBlock Text="Неизвестных: " />
                            <TextBlock x:Name="UnknownFilesTextBlock" Text="0" />
                        </StackPanel>
                        <StackPanel Grid.Column="7" x:Name="NotFoundFilesStackPanel" Orientation="Horizontal"
                                    HorizontalAlignment="Right">
                            <TextBlock Text="Не найдено: " Foreground="Red" />
                            <TextBlock x:Name="NotFoundFilesTextBlock" Text="0" Foreground="Red" />
                        </StackPanel>
                    </Grid>

                    <ListBox Grid.Row="1" x:Name="FilesListBox"
                             ItemContainerStyle="{StaticResource ListBoxItemStyle}"
                             ItemTemplate="{StaticResource FileDataTemplate}"
                             ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                             SelectionMode="Extended"
                             Margin="4,0,4,2"
                             SelectionChanged="FilesListBox_SelectionChanged" />

                    <Grid Grid.Row="2" Margin="4,10,4,4">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Button Grid.Column="0" x:Name="CommentFileButton" Content="Комментарий"
                                Style="{StaticResource FilesButtonStyle}"
                                IsEnabled="False"
                                Click="CommentFileButton_Click" />
                        <!--<TextBlock Grid.Column="1" x:Name="FileNotFoundTextBlock" Text="*Файл не найден"
                                   Foreground="{StaticResource FileNotFoundBrush}"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   Visibility="Collapsed" />-->
                        <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right">
                            <Button x:Name="AddFilesButton" Content="Добавить"
                                Style="{StaticResource FilesButtonStyle}"
                                Click="AddFilesButton_Click" />
                            <Button x:Name="RemoveFilesButton" Content="Удалить"
                                Style="{StaticResource FilesButtonStyle}"
                                Margin="10,0,0,0"
                                IsEnabled="False"
                                Click="RemoveFilesButton_Click" />
                        </StackPanel>
                    </Grid>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- Кнопки нижней части окна -->
        <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button x:Name="SaveButton" Content="Сохранить"
                    IsEnabled="False"
                    Style="{StaticResource ButtonStyle}"
                    Margin="0,0,10,0"
                    Click="SaveButton_Click" />
            <Button x:Name="CancelButton" Content="Отмена"
                    Style="{StaticResource ButtonStyle}"
                    Click="CancelButton_Click" />
        </StackPanel>
    </Grid>
</Window>
